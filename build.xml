<!-- Build file for ANT -->

<project name="Multiverse" default="dist">

    <property name="application.name" value="multiverse"/>
    <property name="application.version" value="0.1"/>

    <property name="src" value="src"/>
    <property name="src.main" value="${src}/main"/>
    <property name="lib" value="lib"/>
    <property name="lib.provided" value="${lib}/provided"/>
    <property name="lib.support" value="${lib}/support"/>

    <property name="target" value="target"/>
    <property name="classes.main" value="${target}/classes.main"/>
    <property name="classes.tests" value="${target}/classes.test"/>
    <property name="unitreports" value="${target}/junit-reports"/>

    <path id="classpath.provided">
        <fileset dir="${lib.provided}">
            <include name="**/*.jar"/>
        </fileset>
    </path>

    <path id="classpath.support">
        <fileset dir="${lib.support}">
            <include name="**/*.jar"/>
        </fileset>
    </path>

    <target name="clean"
            description="Removes all generated files">

        <delete dir="${target}"/>
    </target>

    <target name="init">
        <tstamp/>
    </target>

    <target name="compile.main"
            description="Compiles the sources of the main package"
            depends="init">

        <mkdir dir="${classes.main}"/>

        <javac debug="on"
               srcdir="${src.main}"
               destdir="${classes.main}"
               source="1.5">
            <classpath>
                <path refid="classpath.provided"/>
            </classpath>
        </javac>

        <copy todir="${classes.main}">
            <fileset dir="${src.main}">
                <exclude name="**/*.java"/>
            </fileset>
        </copy>
    </target>

    <target name="jar"
            depends="compile.main"
            description="Builds the jar without including dependant jars">

        <jar jarfile="${target}/${application.name}-${application.version}.jar"
             basedir="${classes.main}"/>
    </target>

    <target name="test"
            depends="compile.main">

    </target>

    <target name="dist"
            description="Builds all the binaries from scratch"
            depends="clean, compile.main, test, jar"/>

</project>
